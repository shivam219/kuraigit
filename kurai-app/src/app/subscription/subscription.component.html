<div class="container mt-4">
  <!-- Client Bought Subscription Plans -->
  <div class="row">
    <div class="col-12 mb-3">
      <h4>Your Subscription Plans</h4>
    </div>

    <div class="col-md-12 mb-3" *ngFor="let clientPlan of clientBoughtSubscriptionPlans; let i = index">
      <div class="card p-3 shadow-sm h-100">
        <div class="d-flex justify-content-between align-items-stretch flex-column flex-md-row h-100">
          <!-- Left Side: Plan Details -->
          <div class="flex-fill me-md-3">
            <span class="">{{ clientPlan.title }}</span>
            <br><span class="">{{ clientPlan.planName }}</span>
            <br><span class="text-muted">{{ clientPlan.description }}</span>
            <br><span>Price: ₹{{ clientPlan.amount }}</span>
            <br><span>Scans Allowed: {{ clientPlan.numberOfScans }}</span>
            @if (clientPlan.active=='Y') {
            <br><span>Remain Scanners: ₹{{ clientPlan.remainingScans }}</span>
            <br><span>Plan Start Date : {{ clientPlan.planStartDate | date:'medium' }}</span>
            }
            <br><span>Plan Buy Date: {{ clientPlan.planBuyDate | date:'medium' }}</span>
          </div>
          <!-- Right Side: Activate Button aligned at the bottom -->
          @if (clientPlan.active=='Y') {
          <div class="d-flex align-items-end justify-content-md-end mt-3 mt-md-0">
            <button class="btn btn-primary disabled ">Activated </button>
          </div>
          } @else if(clientPlan.autoActive=='Y'){
          <div class="d-flex align-items-end justify-content-md-end mt-3 mt-md-0">
            <button class="btn btn-primary disabled "> Auto Activated</button>
          </div>
          } @else {
          @if (isActiveEntry()) {
          <div class="d-flex align-items-end justify-content-md-end mt-3 mt-md-0">
            <button class="btn btn-primary" (click)="turnOnAutoActivateNow(i,clientPlan.id)">Turn On Auto
              Activate</button>
          </div>
          }@else{
          <div class="d-flex align-items-end justify-content-md-end mt-3 mt-md-0">
            <button class="btn btn-primary" (click)="ActivateNow(i,clientPlan.id)">Activate Now</button>
          </div>
          }
          }
        </div>
      </div>
    </div>
    <!-- Show message if no plans are available -->
    <div class="col-12" *ngIf="!clientBoughtSubscriptionPlans || clientBoughtSubscriptionPlans.length === 0">
      <div class="alert alert-info text-center">
        No subscriptions active subscriptions.
      </div>
    </div>
  </div>

  <!-- End Client Bought Subscription Plans -->

  <!-- Available Subscription Plans -->
  <div class="row">
    <div class="col-12 mb-3">
      <h4>Available Subscriptions</h4>
    </div>
    <!-- Show cards if plans are available -->
    <div class="col-md-6 mb-3" *ngFor="let plan of availablePlans">
      <div class="card p-3 shadow-sm h-100">
        <span>{{ plan.planName }}</span>
        <span>{{ plan.title }}</span>
        <span class="text-muted">{{ plan.description }}</span>
        <span>Price: ₹{{ plan.amount }}</span>
        <span>Scans Allowed: {{ plan.numberOfScans }}</span>
        <button class="btn btn-primary" (click)="buyPlan(plan.id)">Buy Now</button>
      </div>
    </div>
    <!-- Show message if no plans are available -->
    <div class="col-12" *ngIf="!availablePlans || availablePlans.length === 0">
      <div class="alert alert-info text-center">
        No subscriptions available at the moment.
      </div>
    </div>
  </div>
  <!-- End Available Subscription Plans -->

  <!-- History Link -->
  <div class="mt-4">
    <a routerLink="/subscription-history">View Subscription History</a>
  </div>
  <!--End  History Link -->
</div>